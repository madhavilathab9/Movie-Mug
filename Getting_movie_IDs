from botocore.vendored import requests
import json
import csv
import zlib
import boto3

def lambda_handler(event, context):
    url = 'http://files.tmdb.org/p/exports/movie_ids_07_21_2018.json.gz'
    page = requests.get(url)
    decompressed_data=zlib.decompress(page.content, 16+zlib.MAX_WBITS) 
    #print(decompressed_data)
    s3 = boto3.resource('s3')
    s3.Bucket('movie360').put_object(Key='Movie_ids.csv', Body=decompressed_data)
    
    return 'Hello from Lambda'
